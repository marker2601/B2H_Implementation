<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>B2H Implementation Library</title>
  <meta name="color-scheme" content="light only">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
  <style>
    html { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial; }
    :root {
      --brand:#C2185B; --brandDark:#9B1349; --ink:#0F172A; --pill:#F1F5F9;
      --slate:#64748B; --line:#E2E8F0; --card:#FFFFFF;
    }
    /* Header gradient + subtle light flares */
    .brand-gradient {
      background:
        radial-gradient(1200px 300px at 15% -10%, rgba(255,255,255,.18), transparent 60%),
        radial-gradient(800px 200px at 85% -15%, rgba(255,255,255,.18), transparent 60%),
        linear-gradient(180deg, var(--brand) 0%, var(--brandDark) 100%);
    }
    .card { transition: transform .15s ease, box-shadow .25s ease, border-color .2s ease; }
    .card:hover { transform: translateY(-3px); box-shadow: 0 18px 44px rgba(2, 6, 23, .08), 0 2px 6px rgba(2,6,23,.06); }
    .badge { background: var(--pill); }
    .truncate-2 { display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; }
    .truncate-3 { display:-webkit-box; -webkit-line-clamp:3; -webkit-box-orient:vertical; overflow:hidden; }
    .srch input::placeholder{ color:#E7EAF0; }
    .file-ico {display:grid;place-items:center;border-radius:14px;border:1px solid rgba(203,213,225,.6);height:44px;width:44px;}
    .ico-docx{background:#EEF2FF;color:#3730A3;border-color:#C7D2FE;}
    .ico-pdf{background:#FEE2E2;color:#991B1B;border-color:#FECACA;}
    .ico-xlsx{background:#DCFCE7;color:#166534;border-color:#BBF7D0;}
    .ico-generic{background:#E2E8F0;color:#334155;border-color:#CBD5E1;}
    .sticky-h { position: sticky; top: 0; z-index: 30; }
    .btn { display:inline-flex;align-items:center;gap:.5rem;border-radius:12px;font-weight:600;font-size:.875rem;padding:.55rem .9rem }
    .btn-primary { background:#0F172A;color:white }
    .btn-primary:hover { background:#111827 }
    .btn-ghost { background:transparent;border:1px solid var(--line); }
    .btn-ghost:hover { background:#F8FAFC }
    .btn-chip { border:1px solid #E5E7EB; background:#FFFFFF; }
    .btn-chip.active { background:#0F172A; color:white; border-color:#0F172A; }
    .drawer-open { transform: translateX(0) !important; }
    /* Acronyms floating button */
    .fab { position: fixed; right: 18px; bottom: 18px; z-index: 60; }
    .fab > button { box-shadow: 0 10px 24px rgba(15,23,42,.2); }
    /* Acronyms overlay */
    .overlay { transform: translateX(105%); }
    .overlay-open { transform: translateX(0) !important; }
    .pin-card { background: #fff; border:1px solid #E2E8F0; border-radius: 18px; }
    .pin-card h2 { letter-spacing: -0.01em; }
    .pin-badge { display:inline-flex; align-items:center; gap:.5rem; font-size:.75rem; font-weight:700; color:#0F172A; background:#F1F5F9; border:1px solid #E2E8F0; border-radius:999px; padding:.25rem .6rem; }
    .transcript { max-height: 320px; overflow: auto; border:1px solid #E5E7EB; border-radius: 12px; padding:.75rem; }
    .transcript mark { background: #FEF3C7; }
    .video-shell video { border-radius: 12px; }
    

    
  </style>
</head>
<body class="bg-white text-slate-800 selection:bg-rose-100 selection:text-rose-900">

  <!-- Header -->
  <header class="brand-gradient text-white sticky-h">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-7">
      <div class="flex items-center justify-start gap-4">
        <div>
          <h1 class="text-3xl sm:text-4xl font-extrabold tracking-tight">B2H Implementation Library</h1>
          <p class="mt-1 text-sm text-white/90">
            <span id="docCount">0</span> documents • Search titles, blurbs, and detailed summaries
          </p>
        </div>
      </div>

      <!-- Search + Sort -->
      <div class="mt-5 grid grid-cols-1 md:grid-cols-7 gap-3 items-center">
        <div class="md:col-span-5">
          <label class="block">
            <div class="relative">
              <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-white/85">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-4.35-4.35M10 18a8 8 0 1 1 0-16 8 8 0 0 1 0 16Z" />
                </svg>
              </span>
              <input id="searchInput" type="text" placeholder="Search by topic, task, role, or document name…"
                     class="w-full rounded-2xl bg-white/10 text-white placeholder-white/80 pl-10 pr-4 py-3 outline-none ring-1 ring-white/25 focus:ring-2 focus:ring-white/60"/>
            </div>
          </label>
        </div>
        <div class="md:col-span-2">
          <div class="flex items-center gap-2">
            <label for="sortSel" class="text-sm text-white/90">Sort</label>
            <select id="sortSel" class="w-full rounded-xl bg-white/10 text-white px-3 py-2 ring-1 ring-white/25 focus:ring-2 focus:ring-white/60">
              <option value="relevance">Relevance</option>
              <option value="az">Title A→Z</option>
              <option value="za">Title Z→A</option>
              <option value="category">Category</option>
            </select>
          </div>
        </div>
      </div>
    </div>
  </header>
<!-- Pinned: Budget Helper bundle -->
<section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-6">
  <div class="pin-card p-5 sm:p-6">
    <div class="flex items-start justify-between gap-4 flex-wrap">
      <div class="flex items-center gap-2">
        <span class="pin-badge">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m15 17-3 3-3-3M12 3v17"/></svg>
          Pinned
        </span>
        <h2 class="text-xl sm:text-2xl font-extrabold">Budget Helper</h2>
      </div>
      <div class="text-xs text-slate-500">Video • Excel • Year-1 Budget doc • Transcript</div>
    </div>

    <div class="mt-4 grid grid-cols-1 lg:grid-cols-3 gap-5">
      <!-- Left: Video (top priority) -->
      <div class="lg:col-span-2 video-shell">
        <video id="budgetVideo" controls preload="metadata" class="w-full aspect-video bg-black"
               src="assets/media/Budget calculator.mp4">
          Sorry—your browser can’t play this video.
        </video>
        <div class="mt-3 flex flex-wrap gap-2">
          <button id="btnTranscript" class="btn btn-ghost">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5V5a2 2 0 0 1 2-2h9.5L20 7.5V19a2 2 0 0 1-2 2H6a2 2 0 0 1-2-1.5Z"/><path d="M14 3v4h4"/></svg>
            Show Transcript
          </button>
          <button id="btnJumpToExcel" class="btn btn-primary">
            Jump to Excel Tips in Transcript
          </button>
        </div>
        <div id="transcriptWrap" class="mt-3 hidden">
          <div class="flex items-center justify-between mb-2">
            <h3 class="font-semibold">Transcript</h3>
            <input id="trSearch" type="text" placeholder="Find in transcript…" class="rounded-lg border border-slate-300 px-2 py-1 text-sm">
          </div>
          <div id="transcript" class="transcript text-sm text-slate-700"></div>
        </div>
      </div>

      <!-- Right: Files (Excel first) -->
      <div class="lg:col-span-1">
        <div class="rounded-2xl border border-slate-200 p-4 bg-white">
          <h4 class="text-sm font-semibold text-slate-700">Downloads</h4>
          <div class="mt-3 space-y-3">
            <!-- Excel on top -->
            <a href="docs/Client_Budget_Calculator_v2.xlsx" class="w-full btn btn-primary justify-between" download>
              <span class="flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M16 8v8M8 8v8M4 12h16"/></svg>
                Client Budget Calculator (Excel)
              </span>
              <span class="text-xs opacity-80">.xlsx</span>
            </a>

            <!-- Budget doc -->
            <a href="docs/Draft Year one Budget.docx" class="w-full btn btn-ghost justify-between" download>
              <span class="flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M7 3h7l5 5v11a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2Z"/></svg>
                Draft Year-1 Budget (Doc)
              </span>
              <span class="text-xs opacity-80">.docx</span>
            </a>

            <!-- Optional: open the Excel in the browser if user has handlers -->
            <a href="docs/Client_Budget_Calculator_v2.xlsx" class="w-full btn btn-ghost justify-between">
              <span class="flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/></svg>
                View in browser (if supported)
              </span>
            </a>
          </div>

          <hr class="my-4">
          <div class="text-xs text-slate-600 leading-relaxed">
            <strong>What’s inside:</strong>
            <ul class="list-disc ml-4 mt-1 space-y-1">
              <li><em>Video</em>: walkthrough of the budget logic & calculator.</li>
              <li><em>Excel</em>: client-level calculator with editable inputs.</li>
              <li><em>Doc</em>: Year-1 budget narrative & categories.</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

  </div>
</section>

  <!-- Content -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
      <!-- Filters -->
      <aside class="lg:col-span-3">
        <div class="rounded-2xl border border-slate-200 p-4">
          <h3 class="text-sm font-semibold text-slate-700 mb-3">Categories</h3>
          <div id="filters" class="flex flex-wrap gap-2"></div>
          <hr class="my-4"/>
          <p class="text-xs text-slate-500">
            Tip: try “inspection”, “invoice”, “ISH/ESH”, “triage”, “onboarding”, or “landlord”.
          </p>
        </div>
      </aside>

      <!-- Cards -->
      <section class="lg:col-span-9">
        <div id="cardsGrid" class="grid sm:grid-cols-2 xl:grid-cols-3 gap-6"></div>
      </section>
    </div>
  </main>

  <!-- Document Drawer -->
  <aside id="drawer" class="fixed inset-y-0 right-0 w-full max-w-lg bg-white border-l border-slate-200 shadow-2xl translate-x-full transition-transform duration-300 z-50">
    <div class="h-full flex flex-col">
      <div class="flex items-center justify-between px-5 py-4 border-b">
        <h3 id="drawerTitle" class="text-lg font-semibold">Document</h3>
        <button id="drawerClose" class="rounded-lg px-2 py-1 hover:bg-slate-100" aria-label="Close">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m6 6 12 12M6 18 18 6"/></svg>
        </button>
      </div>
      <div class="p-5 space-y-4 overflow-y-auto">
        <div class="text-sm text-slate-700">
          <p id="drawerBlurb" class="whitespace-pre-line"></p>
        </div>
        <div class="flex items-center gap-3">
          <a id="drawerView" href="#" class="btn btn-primary">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
            View
          </a>
          <a id="drawerDownload" href="#" class="btn btn-ghost">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 3v12m0 0 4-4m-4 4-4-4M4 21h16"/></svg>
            Download
          </a>
        </div>
      </div>
    </div>
  </aside>
  <div id="drawerBackdrop" class="fixed inset-0 bg-black/20 backdrop-blur-[1px] z-40 hidden"></div>

  <!-- Footer with bigger Centric logo -->
  <footer class="border-t">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 flex items-center justify-between">
      <!-- Left: TASC -->
      <div class="flex items-center gap-3 min-w-0">
        <img id="tascLogo" src="assets/tasc-logo.png" alt="TASC" class="h-12 sm:h-14 lg:h-16 w-auto object-contain">
        <span class="text-xs text-slate-500 truncate">© TASC – B.R.I.D.G.E. To Home</span>
      </div>
      <!-- Right: Centric (larger) -->
      <div class="flex items-center gap-2 shrink-0">
        <span class="text-xs text-slate-500">Prepared by</span>
        <img id="centricLogo" src="assets/centric-logo.png" alt="Centric Strategies" class="h-14 sm:h-16 lg:h-20 w-auto object-contain">
        <span class="text-xs text-slate-600">Centric Strategies</span>
      </div>
    </div>
  </footer>

  <!-- Floating Acronyms Button -->
  <div class="fab">
    <button id="openAcronyms"
            class="rounded-full bg-white text-slate-900 border border-slate-200 px-4 py-2 text-sm font-semibold hover:bg-slate-50">
      Acronyms
    </button>
  </div>

  <!-- Acronyms Overlay (slides in from right) -->
  <aside id="acronymsPanel" class="overlay fixed inset-y-0 right-0 w-full max-w-xl bg-white border-l border-slate-200 shadow-2xl transition-transform duration-300 z-[70]">
    <div class="h-full flex flex-col">
      <div class="flex items-center justify-between px-5 py-4 border-b">
        <div>
          <h3 class="text-lg font-semibold">Acronyms & Terms</h3>
          <p class="text-xs text-slate-500">Quick reference for documents in this library</p>
        </div>
        <button id="closeAcronyms" class="rounded-lg px-2 py-1 hover:bg-slate-100" aria-label="Close acronyms panel">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m6 6 12 12M6 18 18 6"/></svg>
        </button>
      </div>
      <div class="p-5 border-b">
        <div class="relative">
          <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-slate-400">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 21l-4.35-4.35M10 18a8 8 0 1 1 0-16 8 8 0 0 1 0 16Z"/></svg>
          </span>
          <input id="acrSearch" type="text" placeholder="Search acronyms or definitions…"
                 class="w-full rounded-xl bg-white text-slate-900 pl-9 pr-3 py-2 ring-1 ring-slate-200 focus:ring-2 focus:ring-slate-400 outline-none"/>
        </div>
      </div>
      <div class="p-0 overflow-y-auto">
        <ul id="acrList" class="divide-y divide-slate-100"></ul>
      </div>
    </div>
  </aside>
  <div id="acronymsBackdrop" class="fixed inset-0 bg-black/20 backdrop-blur-[1px] z-[65] hidden"></div>

  <script>
    // -------------------------
    // DATA: Library (unchanged – your docs)
    // -------------------------
    const DOCS = [
      { title:"24/7 Hotline SOP (Landlords & Participants)", blurb:"Always-available contact pathway; triage, escalation, documentation, follow-up.", href:"docs/24x7_Hotline_SOP.docx", tag:"Protocols", category:"Protocols",
        summary:"Standard operating procedures for the B2H hotline covering purpose, scope, definitions, hours/access, RACI roles (Triage Specialist, On-Call Case Manager, Supervisor, PQI/Data), and verification steps. Includes a decision tree for life-safety (911 guidance and notifications), urgent non-life-safety (lockout, leaks, heat outage, welfare checks) with warm transfers and paging rules, and routine requests (AP/billing, minor maintenance) queued to case managers. Sets response SLAs (pickup, callback, escalation), ready-to-use scripts, and ECR documentation templates (Hotline Incident note, follow-up task, supervisor notification). Addresses special scenarios (behavioral health/SUD distress, bridge housing incidents, law enforcement), on-call scheduling, contingency/outage procedures, metrics/PQI review, privacy/ROI/PHI safeguards, and training/tabletop exercises. Key appendices list call categories and required ECR data elements." },
      { title:"72 Hour Move In protocol", blurb:"72-hr orientation for tenant/landlord; move-in kit; stabilization.", href:"docs/72 Hour Move In protocol.docx", tag:"Protocols", category:"Protocols",
        summary:"Structured 72-hour stabilization plan immediately post-placement. Day 1: tenant orientation and unit onboarding (walkthrough, basic operations, lease review/acknowledgment, case management expectations, emergency protocol/24-7 hotline, move-in kit delivery and inventory). Day 2: landlord orientation (program role of TASC, incentives and payment processes, documentation requirements for eligibility, incident/lease-violation reporting, contacts, compliance reminders). Day 3: joint landlord-tenant-case manager meeting to establish rapport, define communication preferences/boundaries, capture concerns/accommodations, align expectations, and document completion forms/ISP updates. Includes a standard move-in kit bill of materials and mandates ECR logging, signatures, and supervisor approval for exceptions." },
      { title:"Administrator Job Description", blurb:"Operations, compliance, reporting, staff leadership.", href:"docs/Administrator Job Description.docx", tag:"Roles", category:"Roles",
        summary:"Exempt leadership role responsible for daily operations across a wide geography: administration, personnel supervision, IS systems, reporting, and contract/budget deliverables. Core functions: QA/compliance monitoring, performance against benchmarks, data/reporting to funders, policy implementation, team coaching and performance management, HR partnership for recruitment/retention, and external relations with partners/funders/government. Qualifications emphasize master’s (LSW/LCSW or LPC/LCPC preferred), 3+ years supervisory experience in human services/reentry, knowledge of housing/HUD/tenant rights, on-call responsiveness, and ability to work in secured settings." },
      { title:"Agency Flyer", blurb:"One-page outreach for agencies.", href:"docs/Agency Flyer.pdf", tag:"Partnerships", category:"Partnerships",
        summary:"Single-page explainer inviting service agencies to partner with B2H: program purpose, eligibility, supports (case management, housing navigation, stabilization), and collaboration cadence. Shows how to engage (contact/QR), expected timelines, and what to bring to the first conversation." },
      { title:"Agency Partnership Overview", blurb:"Slide deck: program, roles, supports, FAQs, next steps.", href:"docs/Agency_Overview.pdf", tag:"Partnerships", category:"Partnerships",
        summary:"Deck describing B2H and the central role agencies play in housing stability. Covers program model (placements + wraparound services; intensive case management; 24/7 hotline), agency responsibilities (identify clients, coordinate ISPs with TASC, provide services, participate in case conferencing and reporting), supports to agencies (orientation, clear referrals, housing liaisons, shared resources), FAQs, and next steps (contact B2H, submit LOI/Interest Form, onboarding calls, begin referrals)." },

      { title:"Agency Referral Form", blurb:"Submit referrals from TASC to partner agencies.", href:"docs/Agency_Referral_Form.docx", tag:"Workflows", category:"Workflows",
        summary:"Structured form to connect clients to partner service agencies. Captures referrer details, client identifiers, current housing status, services requested (MH, SUD, employment, education, family), readiness/willingness, barriers (transportation, scheduling), and follow-up workflow (date sent, agency contact, appointment, projected lease-up, verification call, engagement outcomes). Signature lines for referring staff and CM." },
      { title:"Bridge Housing – Partner Info Sheet", blurb:"Expectations, limits, check-ins, incident response.", href:"docs/Bridge_Housing_Partner_Info_Sheet.docx", tag:"Partnerships", category:"Partnerships",
        summary:"Overview for bridge-housing partners (hotels/motels, SROs, transitional). Purpose of short-term stays; expectations (habitability, coordination with TASC, monthly invoicing), typical stay limits, support model (regular CM check-ins; 24/7 hotline). Incident response (hotline/911) and partnership types. Next steps to express interest and receive onboarding/invoicing materials." },
      { title:"Bridge Housing – Referral Form", blurb:"Internal request for short-term bridge housing.", href:"docs/Bridge_Housing_Referral_Form.docx", tag:"Workflows", category:"Workflows",
        summary:"Internal form to request a bridge placement: referrer info, client identifiers, county, current status, permanent housing timeline, reason (unit not ready, inspection pending, admin delay), preference (hotel/motel, SRO, transitional), special considerations (ADA, proximity). Captures check-in frequency, assigned CM, risk factors, and authorization." },
      { title:"Case Manager Job Description", blurb:"Core duties & competencies for reentry case management.", href:"docs/Case Manager Job Description.docx", tag:"Roles", category:"Roles",
        summary:"Direct service role delivering specialized reentry case management: intakes and screenings, ISP/stabilization planning, tenancy coaching, home visits, conflict mediation, referrals (BH/employment/legal), move-in supports, ECR documentation, data/outcome tracking, multidisciplinary staffing. Qualifications: bachelor’s preferred; 2+ years CM; Housing First; MS Office; strong facilitation; CADC/CARS timelined; justice-impacted encouraged." },
      { title:"Client Referral Workflow", blurb:"From IDOC referral to lease-ready placement and stabilization.", href:"docs/Client Referral Workflow.docx", tag:"Workflows", category:"Workflows",
        summary:"End-to-end process ~90 days pre-release: secure intake packet; quick eligibility; CM assignment; landlord engagement & unit matching; intake & Supportive Housing Eligibility/Readiness Assessment (ISH/ESH); inspection; documentation (ISP, lease, W-9/ACH); supervisory approval; move-in day logistics; 72-hour protocol; post-placement check-ins and outcome tracking at 6/12 months." },

      { title:"Data Coordinator Job Description", blurb:"Performance data entry, QA, and reporting.", href:"docs/Data Coordinator Job Description.docx", tag:"Roles", category:"Roles",
        summary:"Role within PQI focused on data accuracy/completeness, CRM reconciliation, trend analysis, and timely monthly/quarterly reports. Supports ops via master docs and gathering inputs from landlords/stakeholders. Requires 2+ yrs admin + 2+ yrs data entry/reporting, advanced MS Office, and strong attention to detail; includes schedule/travel/background expectations." },
      { title:"Driver Job Description", blurb:"Transport clients safely between IDOC, housing, and services.", href:"docs/Driver Job Description.docx", tag:"Roles", category:"Roles",
        summary:"Provides transportation from facilities to housing and services. Duties: safe driving, daily/monthly inspections, logs, cost-effective routing, liaison communication, documentation, and policy adherence; plus professional development. Qualifications: HS diploma, valid IL license, 1–2 yrs driving/transport, GPS familiarity, boundaries/confidentiality, CPR/First Aid; background/drug screening." },
      { title:"Frequently Asked Questions", blurb:"Common questions for landlords and partner agencies.", href:"docs/Frequently Asked Questions.docx", tag:"Overview", category:"Overview",
        summary:"Two-audience FAQ. Landlords: what B2H is, tenant supports, incentives (vacancy coverage, unit prep, possible advance rent), incident process (hotline), responsibilities, how to start (LOI/Interest Form). Agencies: who you serve, supports (training, coordination tools), how to join (LOI → readiness → onboarding), expectations (collaboration, consistent reporting)." },
      { title:"Housing Eligibility Screening and Intake & Readiness", blurb:"Screening tool for eligibility and level of care (ISH vs. ESH).", href:"docs/Housing Eligibility Screening and Intake & Readiness.docx", tag:"Assessments", category:"Assessments",
        summary:"Supportive-housing screening pairing objective criteria with clinical judgment. Captures eligibility, MH diagnoses/meds/adherence, risk (SI/HI), cognition, SUD history, risk level, wraparound needs, and Daily Living Skills ratings. Identifies protective factors and risk indicators; produces a recommendation: ISH, ESH, or higher-acuity referral; includes signatures." },
      { title:"Housing Match Workflow", blurb:"End-to-end matching steps with legal/service constraints.", href:"docs/Housing Match Workflow.docx", tag:"Workflows", category:"Workflows",
        summary:"Eight-step matching flow: readiness/level-of-care confirmation; needs & legal restrictions; landlord/unit identification; pre-inspection; match scoring (legal compliance, proximity, readiness, willingness); case conference; lease execution & move-in; stabilization & monitoring (ISH monthly; ESH weekly+)." },

      { title:"Housing Provider Directory", blurb:"Provider contacts and service areas.", href:"docs/Housing Provider Directory.xlsx", tag:"Overview", category:"Overview",
        summary:"Master spreadsheet of housing providers for matching and outreach. Typical fields: provider, contact, counties served, unit types, rents, voucher acceptance, notes (reentry-friendly), inspection requirements, and collaboration history. Filter by county, proximity, accessibility, and participation status." },
      { title:"Implementation Plan", blurb:"Phased plan & milestones.", href:"docs/Implementation Plan.docx", tag:"Overview", category:"Overview",
        summary:"Six-phase roadmap with milestones/outputs and governance cadence, from feasibility and SOP/template builds to launch, scale/stabilize, and continuous improvement. Includes staffing, bridge vendor onboarding, landlord outreach, go-live checklist, KPI dashboards, PQI audits, and Year-2 planning." },
      { title:"Incident Triage Decision Tree", blurb:"Safety triage and escalation.", href:"docs/Incident Triage Decision Tree.docx", tag:"Protocols", category:"Protocols",
        summary:"Decision tree for life-safety vs. urgent vs. routine. Immediate danger → 911 + notify on-call. MH crisis → on-call CM or 911 if escalating. Lease violations → document/report within 24h. Includes de-escalation tips, documentation standards, CM follow-up SLAs (ISH 48h; ESH 24h), hotline intake script, and routing expectations." },
      { title:"Internal Bridge Housing Protocol", blurb:"Bridge housing guidance.", href:"docs/Internal_Bridge_Housing_Protocol.docx", tag:"Protocols", category:"Protocols",
        summary:"SOP for short-term bridge placements: referral prerequisites, supervisor approval, vendor setup (codes, agreements, W-9/ACH), default stays ≤90 days with extension rules, check-in cadence, incident response via hotline/911, invoicing verification, and transition/exit planning with final inspection and ECR closure." },
      { title:"KPIs with Recommend Tracking", blurb:"KPIs for placement, services, stability.", href:"docs/KPIs_with_Recommend Tracking.docx", tag:"Overview", category:"Overview",
        summary:"Catalog of current and recommended KPIs with tracking methods. Existing: timely placement, ISP completion, BH/medical linkage, 72-Hour protocol, CM touchpoints, retention, landlord engagement, incident response. Recommended: referral-to-placement time, language access, satisfaction, ISP milestones, benefits, employment linkage, landlord retention/reutilization, and legal compliance." },

      { title:"Landlord Flyer", blurb:"Why partner, supports, and how to get started.", href:"docs/Landlord Flyer.pdf", tag:"Partnerships", category:"Partnerships",
        summary:"One-page invite for property owners: program overview (housing + supports), value to landlords (reliable rent, coordinated supports), and how to begin (LOI/Interest Form, orientation). QR for quick start and central contact." },
      { title:"Landlord Overview Deck", blurb:"Slide deck: program, supports, incentives, FAQs.", href:"docs/Landlord Overview Deck.pdf", tag:"Partnerships", category:"Partnerships",
        summary:"Presentation for landlords: B2H mission, placement flow, wraparound supports, benefits/incentives, responsibilities, incident handling via hotline, and onboarding steps." },
      { title:"Landlord Incentive Proposal", blurb:"Proposed menu to recruit and retain landlords.", href:"docs/Landlord_Incentive_Proposal.docx", tag:"Partnerships", category:"Partnerships",
        summary:"Incentive menu to build a second-chance landlord pipeline: signing bonus, risk-mitigation funds, holding fees, repair/readiness stipends, retention bonus, and optional advance-rent models. Includes eligibility, verification, and administration plan." },
      { title:"Landlord Invoice and Process", blurb:"Monthly invoice template and payment workflow.", href:"docs/Landlord_Invoice_and_Process.docx", tag:"Partnerships", category:"Partnerships",
        summary:"Standard invoice package and clear payment flow: vendor code assignment, monthly pre-generated forms, submission reminders, CM occupancy verification, finance cross-check, ACH/check issuance, and signature requirements." },
      { title:"Landlord Orientation Packet", blurb:"Onboarding packet: program, incentives, HQS, forms, contacts.", href:"docs/Landlord_Orientation_Packet.docx", tag:"Partnerships", category:"Partnerships",
        summary:"Comprehensive provider onboarding: program intro; population served; 24/7 hotline; incident reporting; incentive options and claim process; compliance (HQS pre-inspection, maintenance SLAs); and forms (lease template, HQS checklist, W-9/ACH, incentive claim, sign-offs)." },

      { title:"Lease Violation / Incident Form", blurb:"Incident/violation report.", href:"docs/Lease_Violation_Incident_Form.docx", tag:"Protocols", category:"Protocols",
        summary:"Complete within 24h: general info, type, narrative, threat assessment, immediate actions, support requested, history, notes, signature. Emergencies: hotline/911 first, then submit." },
      { title:"Move-In Checklist", blurb:"Move-in kit checklist.", href:"docs/Move-In Checklist.docx", tag:"Protocols", category:"Protocols",
        summary:"Comprehensive kit & onboarding checklist: household essentials, hygiene, clothing basics, safety/comfort, optional food starter, orientation packet, optional add-ons, and culturally responsive/adaptive options." },
      { title:"Network Housing Developer Job Description", blurb:"Landlord outreach & pipeline.", href:"docs/Network Housing Developer Job Description.docx", tag:"Roles", category:"Roles",
        summary:"Build/maintain reentry-friendly housing pipeline: recruit/educate landlords, inspections, lease logistics, unit readiness, documentation, ECR entries, directory upkeep, community/partner meetings. Qualifications emphasize housing/landlord engagement and fair-housing familiarity." },
      { title:"Opportunity Notice", blurb:"Program overview & counties.", href:"docs/Opportunity Notice.docx", tag:"Overview", category:"Overview",
        summary:"Public overview of the B2H pilot (Madison, Sangamon, St. Clair). Mission, context (reentry homelessness risk), value to landlords/agencies, and next steps (contact, LOI, readiness, onboarding)." },
      { title:"Peer Support Specialist Job Description", blurb:"Peer role supporting recovery.", href:"docs/Peer Support Specialist Job Description.docx", tag:"Roles", category:"Roles",
        summary:"Uses lived experience to promote engagement, recovery, and stability: relationship-building, appointments, ISP collaboration, groups, coping skills, move-in support, linkages, documentation, safety escalation; CRSS/CPRS preferred or attainable." },

      { title:"Pilot Program Staffing Model", blurb:"60-participant staffing mix.", href:"docs/Pilot Program Staffing Model.docx", tag:"Overview", category:"Overview",
        summary:"Role mix/FTEs/salary bands sized for ~60 participants: Ops leadership, Supervisors, Case Managers, Peer Support, Housing Developers, Data Coordinator, Drivers, and evaluation support." },
      { title:"Pre & Post Release Placement Timeline", blurb:"Milestones pre/post release.", href:"docs/Pre_Post_Release_Placement_Timeline.docx", tag:"Workflows", category:"Workflows",
        summary:"Referral → eligibility → assignment → matching/inspection → lease/move-in → 72-hour protocol → first 30-day stabilization (linkage windows and check-ins)." },
      { title:"Recommendations", blurb:"Program enablement recommendations.", href:"docs/Recommendations.docx", tag:"Overview", category:"Overview",
        summary:"Enablement list: DocuSign invoicing, behavior-tracked outreach with follow-ups, email packs, funnel tracker, VO video, document portal, KPI page, rental-payment tracker, evaluation track, language access, multi-language materials." },
      { title:"Roles and Responsibilities", blurb:"Duties by role.", href:"docs/Roles and Responsibilities.docx", tag:"Roles", category:"Roles",
        summary:"At-a-glance matrix of Director, Administrator, Supervisor, Case Manager, Peer Support, Housing Developer, Data Coordinator, Driver, and evaluation support responsibilities." },
      { title:"Service Provider Directory", blurb:"Service provider contacts.", href:"docs/Service_Provider.xlsx", tag:"Overview", category:"Overview",
        summary:"Master Excel directory for referrals: agency, program type, contacts, coverage areas, eligibility notes, languages; filter by county/service/language; keep capacity/intake notes current." },

      { title:"HQS Pre-Inspection Checklist", blurb:"Pre-HQS check before lease-up.", href:"docs/HQS_Pre_Inspection_Checklist.docx", tag:"Protocols", category:"Protocols",
        summary:"Field checklist verifying habitability prior to formal inspection: health/safety, living/bedroom, kitchen, bathroom, utilities, exterior/common. Result: Pass / Conditional (repairs) / Fail; with signatures." },
      { title:"Sub-Contracting Workflow", blurb:"Process to engage and manage subcontractors.", href:"docs/Sub-Contracting Workflow.docx", tag:"Workflows", category:"Workflows",
        summary:"Identification → due diligence (MOU, licenses, scope, budget, W-9, COI) → approval (TASC/funder as needed) → onboarding (referral/data workflows, access) → oversight (check-ins, reports, invoices, compliance)." },
      { title:"Suitability Assessment", blurb:"Readiness/level-of-care assessment.", href:"docs/Suitability_Assessment.docx", tag:"Assessments", category:"Assessments",
        summary:"Tool with threshold screening, MH/cognition, daily living, risk/protective, substance use, and scoring that recommends ISH vs. ESH vs. higher care, with assessor notes/override." },
      { title:"Supervisor Job Description", blurb:"Clinical supervision, team leadership, QA.", href:"docs/Supervisor Job Description.docx", tag:"Roles", category:"Roles",
        summary:"Leads multidisciplinary team; ensures individualized, evidence-based care; oversees operations, QA, reporting, staffing, and partner relationships; master’s + IL license required; supervisory experience." },

      { title:"Stabilization and Ongoing Supports SOP", blurb:"Post-move-in cadence & escalation.", href:"docs/Stabilization and Ongoing Supports SOP.docx", tag:"Protocols", category:"Protocols",
        summary:"Ongoing supports after placement: visit cadence (ISH vs. ESH), case conferencing, ISP updates, documentation within set timelines, and escalation ladder (ISH/ESH) through hotline and supervisory review." }
    ];

    // -------------------------
    // DATA: Acronyms & Terms (searchable in overlay)
    // -------------------------
    const ACRONYMS = [
      ["ACH","Automated Clearing House (electronic bank transfer for payments)"],
      ["ADA","Americans with Disabilities Act (accessibility requirements)"],
      ["AP","Accounts Payable (finance function paying invoices)"],
      ["BH","Behavioral Health (includes mental health and substance use)"],
      ["B2H","BRIDGE To Home (program name: Building Resilience, Independence, Dignity, Growth, Empowerment)"],
      ["CADC","Certified Alcohol and Drug Counselor (credential)"],
      ["CARS","Computerized Assessment and Referral System / state credential pathway (contextual)"],
      ["CM","Case Manager"],
      ["COI","Certificate of Insurance (vendor/landlord documentation)"],
      ["CRM","Customer/Client Relationship Management system (data system)"],
      ["ECR","Electronic Case Record (system of record for notes/tasks/files)"],
      ["EEO","Equal Employment Opportunity"],
      ["ESH","Enhanced Supportive Housing (higher-intensity supportive housing)"],
      ["FTE","Full-Time Equivalent (staffing measure)"],
      ["HQS","Housing Quality Standards (habitability checklist/inspection)"],
      ["HUD","U.S. Department of Housing and Urban Development"],
      ["IDOC","Illinois Department of Corrections"],
      ["ISH","Independent Supportive Housing (lower-intensity supportive housing)"],
      ["ISP","Individualized Service Plan (case plan)"],
      ["KPI","Key Performance Indicator"],
      ["LOI","Letter of Intent (also used as Interest Form for partners/landlords)"],
      ["MOU","Memorandum of Understanding (agreement)"],
      ["MSR","Mandatory Supervised Release (parole)"],
      ["NHD","Network Housing Developer (landlord outreach / unit pipeline)"],
      ["PHI","Protected Health Information (HIPAA-covered)"],
      ["PMO","Project Management Office / governance cadence"],
      ["PQI","Performance & Quality Improvement (data/QA team)"],
      ["P&P","Parole & Probation (justice supervision partners)"],
      ["QA","Quality Assurance"],
      ["QR","Quick Response (code) used on flyers/forms"],
      ["RACI","Responsible, Accountable, Consulted, Informed (roles matrix)"],
      ["ROI","Release of Information (consent to share data)"],
      ["SLA","Service Level Agreement (response/processing timeline)"],
      ["SMI","Serious Mental Illness"],
      ["SOP","Standard Operating Procedure"],
      ["SOR","Sex Offender Registration (residency restrictions apply)"],
      ["SRO","Single Room Occupancy (unit type)"],
      ["SUD","Substance Use Disorder"],
      ["TASC","Treatment Alternatives for Safe Communities (lead agency)"],
      ["W-9","IRS Request for Taxpayer Identification (vendor onboarding)"]
    ];

    // -------------------------
    // UI Helpers
    // -------------------------
    const categories = [
      { name: "All Documents" },
      { name: "Assessments" },
      { name: "Overview" },
      { name: "Partnerships" },
      { name: "Protocols" },
      { name: "Roles" },
      { name: "Workflows" },
    ];
    function iconFor(href){
      const n = href.toLowerCase();
      if (n.endsWith(".pdf")) return "pdf";
      if (n.endsWith(".xlsx") || n.endsWith(".xls")) return "xlsx";
      if (n.endsWith(".docx") || n.endsWith(".doc")) return "docx";
      return "generic";
    }
    function iconClass(kind){
      return kind === "pdf" ? "ico-pdf" :
             kind === "xlsx" ? "ico-xlsx" :
             kind === "docx" ? "ico-docx" : "ico-generic";
    }
    function pill(label){
      return `<span class="badge inline-flex items-center rounded-full px-2.5 py-1 text-xs font-medium text-slate-700">${label}</span>`;
    }
    function countByCategory(){
      const counts = Object.create(null);
      for (const c of categories) counts[c.name]=0;
      for (const d of DOCS){
        counts[d.category] = (counts[d.category]||0)+1;
        counts["All Documents"] = (counts["All Documents"]||0)+1;
      }
      return counts;
    }

    // -------------------------
    // State
    // -------------------------
    let state = { q:"", category:"All Documents", sort:"relevance" };

    // -------------------------
    // Filters (chip-style)
    // -------------------------
    function renderFilters(){
      const holder = document.getElementById("filters");
      const counts = countByCategory();
      holder.innerHTML = categories.map(cat => {
        const active = state.category === cat.name;
        return `<button data-cat="${cat.name}" class="btn btn-chip ${active?'active':''}">
          <span>${cat.name}</span>
          <span class="text-[10px] opacity-75 ml-1">${counts[cat.name]||0}</span>
        </button>`;
      }).join("");

      holder.querySelectorAll("button").forEach(btn => {
        btn.addEventListener("click", e => {
          state.category = e.currentTarget.dataset.cat;
          renderFilters(); renderCards();
        });
      });
    }

    // -------------------------
    // External summaries overrides: /summaries/<filename>.txt
    // -------------------------
    async function loadExternalSummaries(){
      await Promise.all(DOCS.map(async d => {
        try {
          const name = d.href.split("/").pop();
          const res = await fetch(encodeURI("summaries/" + name + ".txt"));
          if (res.ok) d.summary = await res.text();
        } catch(_) {}
      }));
    }

    // -------------------------
    // Search & Sort
    // -------------------------
    function haystack(d){
      return (d.title + " " + (d.blurb||"") + " " + (d.summary||"")).toLowerCase();
    }
    function sortDocs(arr){
      const s = state.sort;
      if (s === "az") return [...arr].sort((a,b)=>a.title.localeCompare(b.title));
      if (s === "za") return [...arr].sort((a,b)=>b.title.localeCompare(a.title));
      if (s === "category") return [...arr].sort((a,b)=> (a.category.localeCompare(b.category)) || a.title.localeCompare(b.title));
      return arr; // relevance = keep filtered order
    }

    // -------------------------
    // Drawer
    // -------------------------
    function openDrawer(d){
      document.getElementById("drawerTitle").textContent = d.title;
      document.getElementById("drawerBlurb").textContent = (d.summary || d.blurb || "");
      const fn = d.href.split("/").pop();
      const view = document.getElementById("drawerView");
      const down = document.getElementById("drawerDownload");
      view.setAttribute("href", encodeURI(d.href));
      down.setAttribute("href", encodeURI(d.href));
      down.setAttribute("download", fn);
      document.getElementById("drawer").classList.add("drawer-open");
      document.getElementById("drawerBackdrop").classList.remove("hidden");
    }
    function closeDrawer(){
      document.getElementById("drawer").classList.remove("drawer-open");
      document.getElementById("drawerBackdrop").classList.add("hidden");
    }
    document.getElementById("drawerClose").addEventListener("click", closeDrawer);
    document.getElementById("drawerBackdrop").addEventListener("click", closeDrawer);

    // -------------------------
    // Cards
    // -------------------------
    function renderCards(){
      const grid = document.getElementById("cardsGrid");
      const q = state.q.toLowerCase();

      const filtered = DOCS.filter(d => {
        const inCat = state.category === "All Documents" || d.category === state.category;
        const inSearch = !q || haystack(d).includes(q);
        return inCat && inSearch;
      });
      const sorted = sortDocs(filtered);

      grid.innerHTML = sorted.map((d, i) => {
        const fn = d.href.split("/").pop();
        const kind = iconFor(d.href);
        return `
        <div class="card rounded-2xl border border-slate-200 p-5 bg-white cursor-pointer" data-idx="${i}">
          <div class="flex items-start justify-between gap-3">
            <div class="flex items-center gap-3">
              <div class="file-ico ${iconClass(kind)}">
                ${
                  kind==="pdf" ? '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M7 3h7l5 5v11a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2Zm7 1.5V9h4.5"/></svg>' :
                  kind==="xlsx" ? '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M16 8v8M8 8v8M4 12h16"/></svg>' :
                  kind==="docx" ? '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M7 3h7l5 5v11a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2Z"/></svg>' :
                  '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="12" r="9"/></svg>'
                }
              </div>
              <div>
                <div class="font-semibold leading-snug hover:underline">${d.title}</div>
                <div class="mt-1">${pill(d.tag)} <span class="ml-2 text-xs text-slate-500">${d.category}</span></div>
              </div>
            </div>
            <a href="${encodeURI(d.href)}" download="${fn}" class="shrink-0 btn btn-primary" title="Download" onclick="event.stopPropagation()">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 3v12m0 0 4-4m-4 4-4-4M4 21h16"/></svg>
              Download
            </a>
          </div>
          <p class="mt-3 text-sm text-slate-600 truncate-3">${d.blurb}</p>
        </div>`;
      }).join("");

      grid.querySelectorAll(".card").forEach((el, idx) => {
        el.addEventListener("click", () => openDrawer(sorted[idx]));
      });

      document.getElementById("docCount").textContent = DOCS.length;
    }

    // -------------------------
    // Acronyms overlay logic
    // -------------------------
    const acrPanel = document.getElementById('acronymsPanel');
    const acrBackdrop = document.getElementById('acronymsBackdrop');
    document.getElementById('openAcronyms').addEventListener('click', ()=> {
      acrPanel.classList.add('overlay-open');
      acrBackdrop.classList.remove('hidden');
      document.getElementById('acrSearch').focus();
    });
    function closeAcr(){
      acrPanel.classList.remove('overlay-open');
      acrBackdrop.classList.add('hidden');
    }
    document.getElementById('closeAcronyms').addEventListener('click', closeAcr);
    acrBackdrop.addEventListener('click', closeAcr);

    function renderAcrList(q=""){
      const list = document.getElementById('acrList');
      const txt = q.trim().toLowerCase();
      const items = ACRONYMS
        .filter(([k,v]) => !txt || k.toLowerCase().includes(txt) || v.toLowerCase().includes(txt))
        .sort((a,b)=> a[0].localeCompare(b[0]));
      list.innerHTML = items.map(([k,v]) => `
        <li class="px-5 py-3">
          <div class="flex items-start justify-between gap-3">
            <div>
              <div class="text-sm font-semibold text-slate-800">${k}</div>
              <div class="text-sm text-slate-600">${v}</div>
            </div>
          </div>
        </li>
      `).join('');
      if (!items.length){
        list.innerHTML = `<li class="px-5 py-6 text-sm text-slate-500">No matches. Try another term.</li>`;
      }
    }
    document.getElementById('acrSearch').addEventListener('input', (e)=> renderAcrList(e.target.value));

    // -------------------------
    // Events
    // -------------------------
    document.getElementById("searchInput").addEventListener("input", (e)=>{ state.q = e.target.value; renderCards(); });
    document.getElementById("sortSel").addEventListener("change", (e)=>{ state.sort = e.target.value; renderCards(); });

    <script>
  // ------- Transcript loader: fetch .vtt, parse to plain text with clickable timestamps
  async function loadVTT(url){
    const res = await fetch(url);
    if(!res.ok) throw new Error('Transcript not found');
    const text = await res.text();

    // Simple WebVTT cue parser (start --> end \n text)
    const lines = text.split(/\r?\n/);
    const cues = [];
    let i=0;
    while(i<lines.length){
      const line = lines[i].trim();
      if(/^\d+$/.test(line)) { i++; continue; }            // ignore numeric cue id
      if(line.includes('-->')) {
        const m = line.match(/(\d+):?(\d{2}):(\d{2})\.(\d{3})/); // first timestamp
        let startSec = 0;
        if(m){
          const h = m[1].length===2 ? parseInt(m[1],10) : 0;
          const mm = parseInt(m[2],10), ss=parseInt(m[3],10), ms=parseInt(m[4],10);
          startSec = h*3600 + mm*60 + ss + ms/1000;
        }
        i++;
        let txt=[];
        while(i<lines.length && lines[i].trim()!==""){
          txt.push(lines[i]);
          i++;
        }
        const cueText = txt.join(' ').replace(/\s+/g,' ').trim();
        if(cueText) cues.push({t:startSec, text:cueText});
      }
      i++;
    }
    return cues;
  }

  // ------- Render transcript with search + jump-to-time
  function renderTranscript(cues, filter=""){
    const wrap = document.getElementById('transcript');
    const needle = filter.trim().toLowerCase();
    wrap.innerHTML = cues.map(({t,text})=>{
      let shown = text;
      if(needle){
        shown = shown.replace(new RegExp(needle.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'ig'), m=>`<mark>${m}</mark>`);
      }
      const hh = Math.floor(t/3600), mm=Math.floor((t%3600)/60), ss=Math.floor(t%60);
      const stamp = (hh>0? String(hh).padStart(2,'0')+':':'') + String(mm).padStart(2,'0')+':'+String(ss).padStart(2,'0');
      return `<div class="py-1.5">
        <button class="text-xs text-rose-700 hover:underline" data-jump="${t}">[${stamp}]</button>
        <span class="ml-2">${shown}</span>
      </div>`;
    }).join('');

    // click-to-seek
    wrap.querySelectorAll('button[data-jump]').forEach(b=>{
      b.addEventListener('click', ()=>{
        const v = document.getElementById('budgetVideo');
        v.currentTime = parseFloat(b.dataset.jump||"0");
        v.play().catch(()=>{});
      });
    });
  }

  // ------- Wire up UI
  (function wireBudgetBundle(){
    const btnT = document.getElementById('btnTranscript');
    const wrap = document.getElementById('transcriptWrap');
    const trInput = document.getElementById('trSearch');
    const jumpExcel = document.getElementById('btnJumpToExcel');
    let cuesCache = null;
    let visible = false;

    btnT?.addEventListener('click', async ()=>{
      visible = !visible;
      wrap.classList.toggle('hidden', !visible);
      btnT.innerHTML = visible
        ? `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5V5a2 2 0 0 1 2-2h9.5L20 7.5V19a2 2 0 0 1-2 2H6a2 2 0 0 1-2-1.5Z"/><path d="M14 3v4h4"/></svg> Hide Transcript`
        : `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5V5a2 2 0 0 1 2-2h9.5L20 7.5V19a2 2 0 0 1-2 2H6a2 2 0 0 1-2-1.5Z"/><path d="M14 3v4h4"/></svg> Show Transcript`;
      if(visible && !cuesCache){
        try {
          cuesCache = await loadVTT('assets/media/GMT20251003-130246_Recording.transcript.vtt');
          renderTranscript(cuesCache);
        } catch(e){
          document.getElementById('transcript').innerHTML = `<div class="text-sm text-slate-500">Transcript not found.</div>`;
        }
      }
    });

    trInput?.addEventListener('input', (e)=>{
      if(cuesCache) renderTranscript(cuesCache, e.target.value);
    });

    // Optional convenience: jump to Excel segment if the transcript contains “excel” or “calculator”
    jumpExcel?.addEventListener('click', ()=>{
      const v = document.getElementById('budgetVideo');
      if(!cuesCache) return;
      const hit = cuesCache.find(c => /excel|calculator|spreadsheet/i.test(c.text));
      if(hit){
        v.currentTime = hit.t; v.play().catch(()=>{});
        if(!visible){ btnT.click(); } // open transcript for context
        trInput.value = "excel"; renderTranscript(cuesCache, "excel");
      }
    });
  })();



    // -------------------------
    // Init
    // -------------------------
    (async function init(){
      renderFilters();
      await loadExternalSummaries(); // supports /summaries/<filename>.txt overrides
      renderCards();
      renderAcrList();
    })();
  </script>
</body>
</html>
